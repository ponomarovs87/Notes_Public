# ๐ ะัะบะพะฒะพะดััะฒะพ ะฟะพ Nginx ั ะฟัะธะผะตัะฐะผะธ

## ๐ ะะณะปะฐะฒะปะตะฝะธะต
- [๐ ะัะบะพะฒะพะดััะฒะพ ะฟะพ Nginx ั ะฟัะธะผะตัะฐะผะธ](#-ััะบะพะฒะพะดััะฒะพ-ะฟะพ-nginx-ั-ะฟัะธะผะตัะฐะผะธ)
  - [๐ ะะณะปะฐะฒะปะตะฝะธะต](#-ะพะณะปะฐะฒะปะตะฝะธะต)
  - [ะงัะพ ัะฐะบะพะต Nginx](#ััะพ-ัะฐะบะพะต-nginx)
  - [ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ ัะฐะนัะฐ](#ะฟัะธะผะตั-ะบะพะฝัะธะณััะฐัะธะธ-ัะฐะนัะฐ)
      - [a. ะคะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ: `/etc/nginx/sites-enabled/site.ua`](#a-ัะฐะนะป-ะบะพะฝัะธะณััะฐัะธะธ-etcnginxsites-enabledsiteua)
      - [b. ะะพัะปะต ะธะทะผะตะฝะตะฝะธั ะบะพะฝัะธะณััะฐัะธะธ:](#b-ะฟะพัะปะต-ะธะทะผะตะฝะตะฝะธั-ะบะพะฝัะธะณััะฐัะธะธ)
  - [ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะฐะนัะฐ](#ะดะพะฑะฐะฒะปะตะฝะธะต-ะฝะพะฒะพะณะพ-ัะฐะนัะฐ)
  - [ะฃะดะฐะปะตะฝะธะต ััะฐัะพะณะพ ัะฐะนัะฐ](#ัะดะฐะปะตะฝะธะต-ััะฐัะพะณะพ-ัะฐะนัะฐ)
  - [ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั](#ะฟะพะปะตะทะฝัะต-ะบะพะผะฐะฝะดั)
- [ะกััะปะบะธ ะธ ัะตััััั](#ัััะปะบะธ-ะธ-ัะตััััั)

---

## ะงัะพ ัะฐะบะพะต Nginx
Nginx โ ััะพ **ะฒััะพะบะพะฟัะพะธะทะฒะพะดะธัะตะปัะฝัะน ะฒะตะฑ-ัะตัะฒะตั ะธ ะพะฑัะฐัะฝัะน ะฟัะพะบัะธ-ัะตัะฒะตั**.

* *ะะพ ัะตะปะพะฒะตัะตัะบะธ: ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะพะณะพ ััะพ ะฟัะธะฝะฐะธะผะตั ะฑัะดะตั ะพัะดะฐะฒะฐัั ัะพ ััะพ ะฝะฐะทะฝะฐัะธัะต ะฒ ะตะณะพ ัะฐะนะปะต*

ะะฝ ัะผะตะตั:
- ะะฑัะปัะถะธะฒะฐัั ััะฐัะธัะตัะบะธะต ัะฐะนะปั (HTML, CSS, JS) ๐ผ๏ธ  
- ะะฐะฑะพัะฐัั ะบะฐะบ ะพะฑัะฐัะฝัะน ะฟัะพะบัะธ ะดะปั ะฟัะธะปะพะถะตะฝะธะน โก  
- ะะพะดะดะตัะถะธะฒะฐัั SSL/TLS ๐  
- ะะฐะปะฐะฝัะธัะพะฒะฐัั ะฝะฐะณััะทะบั ะผะตะถะดั ะฝะตัะบะพะปัะบะธะผะธ ัะตัะฒะตัะฐะผะธ โ๏ธ  

---
## ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ ัะฐะนัะฐ

#### a. ะคะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ: `/etc/nginx/sites-enabled/site.ua`

* *www.site.ua ะทะฐะผะตะฝะธัั ะฝะฐ ะฒะฐั ะดะพะผะตะฝ ัะพะพัะฒะตัััะฒะตะฝะฝะพ ัะตััะธัะธะบะฐัั ะดะปั https ะบะฐะบ ะฟะพะปััะธัั [ะพัะดะตะปัะฝะพ](#ัััะปะบะธ-ะธ-ัะตััััั)*

```nginx
# http://www.site.ua/

server {
    listen 80;
    listen [::]:80;
    server_name site.ua www.site.ua;

    # ัะตะดะธัะตะบั ะฒัะตั HTTP ะทะฐะฟัะพัะพะฒ ะฝะฐ HTTPS
    return 301 https://$host$request_uri;

    # ะฒัะดะฐัะฐ ัะฐะนัะฐ ะทะฐะบะพะผะผะตะฝัะธััะน ะฒะตััะฝัั ัััะพัะบั ัะฐะทะฐะบะพะผะผะตะฝัะธััะน ะดะฒะต ะฝะธะถะฝะธั
    # root /var/www/site.ua;
	# index index.html;
}

# https://www.site.ua/

server {
    listen 443 ssl;
    server_name uvs.site.ua www.site.ua;

    ssl_certificate /etc/letsencrypt/live/site.ua/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/site.ua/privkey.pem;

    root /var/www/site.ua;
    index index.html index.htm;

    # ะฟัะธะผะตั ะฒััะฐะฒะปะตะฝะฝะพะน ะปะพะบะฐัะธะธ ัะพ ะตััั ะฟะพ ะฐะดัะตัั  https://www.site.ua/test/new_site/  ะฑัะดะตั ะธะฝะดะตะบัะฝะฐั ัััะฐะฝะธัะฐ ัะตััะพะฒะพะณะพ ัะฐะนัะฐ (ะพััะพัะพะถะฝะตะน ั ะฝะฐะฒะธะณะฐัะธะตะน ะฒะฝัััะธ ัะตััะพะฒะพะณะพ ัะฐะนัะฐ !!!)
    
    location /test/new_site/ {
        alias /var/www/test/new_site/dist/;
        index index.html;
    }

    location / {
        try_files $uri $uri/ =404;
    }
}

# ะขะตััะพะฒัะน ัะฐะนั (ะฝะฐ ะฟะพััั 3000) http://www.site.ua:3000/

server {
    listen 3000;
    server_name www.site.ua;

    root /var/www/test/new_site/dist/;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}
```
* *http://www.site.ua:3000/ ะฝะฐะฒะธะณะฐัะธั ะฑัะดะตั ะฝะพัะผะฐะปัะฝะฐั ะฝะพ ัะบะพัะตะต ะฒัะตะณะพ ะฒ ะธะฝัะตัะฝะตัะต ะฒั ัะฐะนั ะฝะต ะพัะบัะพะตัะต ะถะตะปะตะทะฝัะน ะทะฐะฝะฐะฒะตั ะพััะฐะฒะธะป ะผะฐะปะพ ะฟะพััะพะฒ ะดะปั ะฟะพะปัะทะพะฒะฐะฝะธั ะธ 3000 ัะฐััะพ ั ะฟัะพะฒะฐะนะดะตัะพะฒ ะทะฐะฑะปะพะบะธัะพะฒะฐะฝ ะฝะพ ะฟัะธ ััะปะพะฒะธะธ ะตัะปะธ ัะพะทะดะฐัั ะฒะฝัััะตะฝะฝัั ะฟัะธะฒะฐัะฝัั ัะตัั ั ัะตัะฒะตัะพะผ ะฒั ะพัะบัะพะตัะต ัะฐะบ ะบะฐะบ ะฒั ัะฒะพะน ะฟัะพะฒะฐะนะดะตั, ะฝะพ ะตัะปะธ ะทะฐัะพัะธัะต ะฒัะนัะธ ะฝะฐ ััะถะพะน ัะฐะนั ั ะดััะณะธะผ ะฟะพััะพะผ ะฑัะดะตัะต ะฟะพะดะฟะฐะดะฐัั ะฟะพั ะฟัะพะฒะฐะนะดะตัะฐ ัะตัะฒะตัะฐ ะธ ะตะณะพ ะฟัะฐะฒะธะปะฐ ะฟะพะดัะพะฑะฝะตะต ะฟัะพ **ะะธัััะฐะปัะฝัั ะัะธะฒะฐัะฝัั ะกะตัั** ัะธัะฐะน [ะพัะดะตะปัะฝะพ](#ัััะปะบะธ-ะธ-ัะตััััั)*

#### b. ะะพัะปะต ะธะทะผะตะฝะตะฝะธั ะบะพะฝัะธะณััะฐัะธะธ:

```bash
sudo nginx -t   # ะัะพะฒะตัะบะฐ ะบะพะฝัะธะณััะฐัะธะธ
```
* *ะฒะฐะถะฝะพ ะฟัะพะฒะตัััั ัะฐะธะป ะบะพะฝัะธะณััะฐัะธะธ ะฟะพะบะฐ ะฝะต ะฟะตัะตะทะฐะณััะทะธะป (ะฒัะต ัะฐะฑะพัะฐัะตั) ะฒ ัะปััะฐะต ะพัะธะฑะบะธ ะปัะถะตั ะฒะตัั **nginx** ะฐ ะฝะต ะพะดะธะฝ ัะฐะนั*


```bash
sudo systemctl reload nginx  # ะะตัะตะทะฐะณััะทะบะฐ ัะตัะฒะตัะฐ
```

ะัะพะฒะตัะบะฐ ัะฐะฑะพัั ัะฐะนัะฐ :

```bash
curl -I https://site.ua/test/aleksandra/
```

## ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะฐะนัะฐ

ะกะพะทะดะฐะตะผ ะฝะพะฒัะน ะบะพะฝัะธะณ-ัะฐะนะป:

```bash
sudo nano /etc/nginx/sites-available/my_new_site.conf
```
ะัะธะผะตั ัะพะดะตัะถะธะผะพะณะพ:

```nginx
server {
    listen 443 ssl;
    server_name my_new_site.com www.my_new_site.com;

    ssl_certificate /etc/letsencrypt/live/my_new_site.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/my_new_site.com/privkey.pem;

    root /var/www/my_new_site.com;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

ะกะพะทะดะฐะตะผ ัะธะผะฒะพะปะธัะตัะบัั ัััะปะบั:

```bash
sudo ln -s /etc/nginx/sites-available/my_new_site.conf /etc/nginx/sites-enabled/
```

ะัะพะฒะตััะตะผ ะธ ะฟะตัะตะทะฐะณััะถะฐะตะผ Nginx:

```bash
sudo nginx -t
```

```bash
sudo systemctl reload nginx
```

## ะฃะดะฐะปะตะฝะธะต ััะฐัะพะณะพ ัะฐะนัะฐ
ะฃะดะฐะปัะตะผ ัะธะผะฒะพะปะธัะตัะบัั ัััะปะบั ะธะท sites-enabled:

```bash
sudo rm /etc/nginx/sites-enabled/old_site.conf
```
(ะะฟัะธะพะฝะฐะปัะฝะพ) ะฃะดะฐะปัะตะผ ัะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ:

```bash
sudo rm /etc/nginx/sites-available/old_site.conf
```
ะะตัะตะทะฐะณััะถะฐะตะผ Nginx:

```bash
sudo nginx -t
```
```bash
sudo systemctl reload nginx
```
* *โ๏ธ ะะฐะถะฝะพ: ัะฝะฐัะฐะปะฐ ัะดะฐะปัะนัะต ัะธะผะฒะพะปะธัะตัะบัั ัััะปะบั, ะฟะพัะพะผ ัะฐะนะป, ะธะฝะฐัะต ะผะพะถะฝะพ ัะปััะฐะนะฝะพ ัะปะพะผะฐัั ัะฐะนั.*

## ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั
```bash
ะะพะผะฐะฝะดะฐ                         ---> ะะฟะธัะฐะฝะธะต
sudo nginx -t                   ---> ะัะพะฒะตัะบะฐ ะบะพะฝัะธะณััะฐัะธะธ
sudo systemctl reload nginx	    ---> ะะตัะตะทะฐะณััะทะบะฐ ะฑะตะท ะพััะฐะฝะพะฒะบะธ
sudo systemctl restart nginx	---> ะะพะปะฝะฐั ะฟะตัะตะทะฐะณััะทะบะฐ
sudo nginx -T	                ---> ะัะฒะพะด ะฒัะตั ะบะพะฝัะธะณััะฐัะธะน

curl -I https://example.com	    ---> ะัะพะฒะตัะบะฐ ะพัะฒะตัะฐ ัะตัะฒะตัะฐ
```

# ะกััะปะบะธ ะธ ัะตััััั
//ะะ ัะฐะฑะพัะฐัั!!! ะะพะบะฐ ะตัะต!

[ะัะธัะธะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั Nginx ๐](https://nginx.org/ru/docs/)

[Let's Encrypt SSL ๐]()